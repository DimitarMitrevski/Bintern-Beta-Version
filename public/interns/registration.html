<!DOCTYPE html>
<html>

<head>
    <title>Bintern - Најава/Регистрација</title>
    <link rel="icon" type="image/gif/png" href="../bintern12.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-storage.js"></script>
    <script src="https://www.google.com/recaptcha/api.js?render=_reCAPTCHA_site_key"></script>
    <script src="../jquery.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" type="text/css" href="bintern7.css"> -->
    <link rel="stylesheet" type="text/css" href="../styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
        integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w=="
        crossorigin="anonymous" />
</head>

<body class="mobilever">
    <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light rounded">
        <a class="navbar-brand" href="#"><img src="../bintern2.png" class="animate__animated animate__backInDown"
                width="175" alt="Bintern logo"></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarsExample09"
            aria-controls="navbarsExample09" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample09">
            <ul class="navbar-nav mr-auto mx-md-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#">Почетна <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="kontakt.html">Контактирај нѐ</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="companies/registration.html">Објави оглас</a>
                </li>


                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="dropdown09" data-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">Повеќе информации</a>
                    <div class="dropdown-menu" aria-labelledby="dropdown09">
                        <a class="dropdown-item" href="bintern4.html">За фирмите</a>
                        <a class="dropdown-item" href="bintern5.html">За практикании</a>
                    </div>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="#" data-toggle="modal" data-target="#myModal">Регистрација/Најава</a>
                </li>
            </ul>

        </div>

    </nav>
       <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Најава/Регистрација</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body"> 
                <div class="container">
                   
              <div class="row justify-content-center"> 
                <button class="btn1 mb-3" onclick="document.location.href='../companies/profile.html'">
            Најави се како компанија
                </button>
            </div>
            <div class="row justify-content-center">
            <button class="btn2 rounded" onclick="document.location.href='profile.html'">
            Најави се како студент
            </button>
            </div>
            <div class="row justify-content-center" onclick="document.location.href='../companies/registration.html'">
            <button class="btn1 mb-3">
            Регистрирај се како компанија
            </button>
            </div>
            <div class="row justify-content-center">
            <button class="btn2 rounded"  onclick="document.location.href='../interns/registration.html'">
            Регистрирај се како практикант
            </button>
              </div>
                    
                </div>
           
       
            </div>
          </div>
        </div>
      </div>
    <div class="container-fluid mt-5 pt-5"></div>

    <div class="row py-3 m-0 ">
        <div class="col-12 m-0">
            <h1 class="font-weight-bolder">Регистрирај се</h1>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row ">

            <div class="col-lg-3 d-none d-md-block"></div>

            <div class="col-lg-6">
                <form  id="formData">
                    <div class="row">
                        <div class="col-lg-6">
                            <label for="exampleInputEmail1">Име</label>
                            <input type="text" id="name" name="name" class="form-control" id="exampleInputname1"
                                aria-describedby="nameHelp" placeholder="Внеси Име" minlength="3" maxlength="10" required>
                            <!-- <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small> -->
                        </div>

                        <div class="col-lg-6">
                            <label for="exampleInputPassword1">Презиме</label>
                            <input type="text" id="surename" name="surename" class="form-control"
                                id="exampleInputPassword1" placeholder="Внеси Презиме" minlength="5" maxlength="20" required>
                        </div>


                    </div>
                         <div class="mt-2">
                        <label for="ime">Факултет</label>
                        <input type="text" name="ime" class="form-control" id="ime" aria-describedby="emailHelp"
                            placeholder="Внесете Факултет" minlength="3" maxlength="20" required>
                    </div>
                    <div class="mt-2">
                        <label for="Email">Е-Маил</label>
                        <input type="email" name="email" class="form-control" id="exampleInputEmail1"
                            aria-describedby="emailHelp" placeholder="Внесете ја вашата валидна Е-Маил адреса" minlength="14" maxlength="40" required>
                    </div>
                  

                    <div class="row">
                        <div class="col-lg-6 mt-2">
                            <label for="password">Лозинка:</label>
                            <input type="password" name="password" class="form-control" id="password"
                                aria-describedby="passwordlHelp" placeholder="Внесете ја лоизнката" minlength="8" maxlength="50" required>
                                <small id="emailHelp" class="form-text text-muted">Лозинката мора да содржи најмалку 8 карактери.</small>
                            </div>
                        <div class="col-lg-6 mt-2">
                            <label for="re-password">Потврдете ја лозинката</label>
                            <input type="password" class="form-control" name="re-password" id="re-password"
                                aria-describedby="rpasswordlHelp" placeholder="Повторно внесете ja лозинката" minlength="8" maxlength="50" required > 
                                <small id="passHelp" class="form-text text-red d-none" >Лозинките не се совпаѓаат.</small>
                            </div>
                    </div>
                    <div class="mt-2">
                        <label for="opis">Опис:</label><br>
                        <small id="emailHelp" class="form-text text-muted text-right">Описот мора да содржи најмалку 155 карактери.</small>
                        <textarea class="w-100" name="opis" id="opis" cols="90" rows="8" minlength="155" maxlength="500" required></textarea>
                    </div>

                    <div class="row">
                        <div class="col-lg-6">
                            <label for="form-control">Позиција</label>
                            <select class="form-control" name="industrija" id="industrija" required>
                                <option value="" disabled selected>Изберете Позиција</option>
                                <option value="Дигитален Маркетер">Дигитален Маркетер</option>
                                <option value="Графички дизајнер">Графички дизајнер</option>
                                <option value="Економист">Економист</option>
                                <option value="Бизнис аналитичар">Бизнис аналитичар</option>
                                <option value="Фронтенд програмер">Фронтенд програмер</option>
                                <option value="Бекенд програмер">Бекенд програмер</option>
                                <option value="Девелопер на мобилни апликации">Девелопер на мобилни апликации</option>
                                <option value="Фул-стек Девелопер">Фул-стек Девелопер</option>
                                <option value="Адвокатски приправник">Адвокатски приправник</option>
                                <option value="Продавач">Продавач</option>
                                <option value="Друго">Друго</option>
                            </select>

                        </div>
                        <div class="col-lg-6">
                            <label for="tel">Контакт телефон</label>
                            <input type="tel" name="tel" class="form-control" id="tel" aria-describedby="numberdlHelp"
                                placeholder="07X-XXX-XXX"  minlength="9" maxlength="9" required >
                        </div>
                    </div>

                    <div class="row justify-content-center pt-3">
                        <div class="col-md-4 text-center choosefile ">
                            <label class="d-block" id="element9" for="logo">Слика за профилот</label>
                            <input id="element10" type="file" accept="image/*" name="logo" placeholder="logo.img">
                        </div>
                    </div>

                    <div class="row my-3">
                        <div class="col-lg-12">
                            <h6 class="d-inline">Се согласувам со условите за користење на БИНТЕРН</h6>
                            <input class="d-inline" type="checkbox" class="form-check-input" id="exampleCheck1"
                                required>
                        </div>
                    </div>

                    <div class="row pb-3 ">
                        <div class="col-lg-12 d-flex justify-content-center">
                            <div class="g-recaptcha" data-theme="dark"
                                data-sitekey="6LcUP-EUAAAAAOOBNmabH3bmpsAUmwXjbdvjhiF9" data-callback="submitUserForm">
                            </div>
                            <div id="g-recaptcha-error"></div>
                        </div>

                    </div>

                    <div class="row mb-5">
                        <div class="col-lg-12 d-flex justify-content-center">
                            <button type="submit" class="btn1">Зачувај Профил</button>
                        </div>

                    </div>


                </form>
            </div>
            <div class="col-lg-3 d-none d-md-block"></div>
        </div>
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title text-center h3 font-weight-bolder" id="exampleModalLabel">Успех!</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                <p class="text-center text-success h4">
                    Успешно се регистриравте!
                </p>
                <div class="d-flex justify-content-center align-items-center">
                    Се пренасочувате...
                    <div class="spinner-border" role="status">
                    <span class="sr-only">Loading...</span>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
    </div>
    <script src="../firebase.js"></script>
    <script type="text/javascript" defer>
    var url='';
    $("#re-password").keyup((events)=>{
 const value = events.target.value;
  const pw=$("#password").val()
 if(value!=pw){
    $("#re-password").addClass('border border-danger');
    $("#passHelp").removeClass('d-none');
 }else{
    $("#re-password").removeClass('border border-danger');
    $("#passHelp").addClass('d-none');
 }
    });
    function submitUserForm() {
    var response = grecaptcha.getResponse();
    if (response.length == 0) {
        document.getElementById('g-recaptcha-error').innerHTML = '<span style="color:red;">Ова поле е потребно.</span>';
        
        return false;
    }
    return true;
}
$("#element10").on('change', async function() {
    var file = this.files[0];
    var fileType = file["type"];
    var validImageTypes = ["image/gif", "image/jpeg", "image/png"];
    if(url!=''){
        await firebase.storage().refFromURL(url).delete().then(()=>console.log('File is deleted')).catch(err=>console.log(err)); 
    }
    if ($.inArray(fileType, validImageTypes) < 0) {
        // invalid file type code goes here.
        window.alert("Избраната датотека мора да биде слика!");
        this.value = '';
    }else if (file.size >2097152) {
    window.alert('Сликата е преголема ве молиме додадете помала слика до 2MB');
    this.value = '';
    } else {
        var image = document.getElementById("element10").files[0];
        // get your imageName
        var imageName = image.name;
        // firebase storage reference
        // it is the path were your image will store
        var storageRef = firebase.storage().ref('images/students/profileImg/' + imageName);
        // upload image to slected storage referece
        var uploadTask = await storageRef.put(image).then(async (snapshot)=>{
           const fileUrl =  await snapshot.ref.getDownloadURL().then((downloadURL) => {
            return downloadURL;
                });
            return fileUrl
            //console.log(snapshot);
        });
      url = uploadTask;
    }                
});

var singupForm = document.querySelector('#formData');
singupForm.onsubmit = async (e) => {
            e.preventDefault();
        if(submitUserForm()){
        const email = singupForm['email'].value;
        const password = singupForm['password'].value;
        const imeFirma = singupForm['ime'].value;
        const industrija = document.getElementById('industrija').value;
        const kontaktTel = singupForm['tel'].value;
        const opis = singupForm['opis'].value;
        const odgLice = `${singupForm['name'].value.trim()} ${singupForm['surename'].value.trim()}`;
       var url = document.getElementById("element10").files[0];
       var student = {
           email:email,
           fakultet:imeFirma,
           pozicija:industrija,
        kontaktTel,
           Opis:opis,
           ImePrezime:odgLice,
        }
        if(window.url!=''){
          student.slika=window.url;
           }
        //sing up the user
        await firebase.auth().createUserWithEmailAndPassword(email, password).then(async cred => {
            $("#exampleModal").modal('show');
            var user = firebase.auth().currentUser;
           await user.sendEmailVerification().then(function () {
                // Email sent
                
            });
            await firebase.database().ref(`students/${user.uid}`).set(student).then(()=>{
                document.location.href="profile.html"; 
            }).catch(function (error) {
            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            window.alert(errorMessage);
            // ...
        });
        
    }).catch(function (error) {
        // An error happened.
    });
       }
};
</script>
<!-- <script src="bintern7.js"></script>
    <script src="menu1.js"></script> -->
</body>




</html>